@{
    Layout = "_Layout.cshtml";
}
<div class="row mt-2">
    <div class="col-sm-10"><h4>Dashboard</h4></div>
</div>
<div class="row shadow-sm p-3">
    <div class="col">
        <input type="date" class="form-control" id="rdateSearch" placeholder="Date">
    </div>
    <div class="col">
        <input type="date" class="form-control" id="todateSearch" placeholder="Date">
    </div>
    <div class="col">
        <select id="daysSearch" class="form-control Status">
            <option value="default">--- Select---</option>
            <option value="1Week">1 Week</option>
            <option value="1Month">1 Month</option>
            <option value="2Month">2 Month</option>
        </select>
    </div>
    <div class="col">
        <button type="button"
                class="btn btn-info" onclick="LoadTable()">
            Search
        </button>
    </div>
</div>
<section class="content">
    <div class="container-fluid">

        <div class="row">
            <div class="col-lg-3 col-6">

                <div class="small-box bg-info">
                    <div class="inner">
                        <h3><span id="Book"></span></h3>
                        <p>Book</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-6">

                <div class="small-box bg-success">
                    <div class="inner">
                        <h3><span id="Unbook"></span></h3>
                        <p>Unbook</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-6">

                <div class="small-box bg-warning">
                    <div class="inner">
                        <h3><span id="Dastavej"></span></h3>
                        <p>Dastavej</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-3 col-6">

                <div class="small-box bg-danger">
                    <div class="inner">
                        <h3><span id="Banakhat"></span></h3>
                        <p>Banakhat</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-6">

                <div class="small-box bg-secondary">
                    <div class="inner">
                        <h3><span id="totalPaid"></span></h3>
                        <p>Amount received</p>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header border-0">
                <div class="d-flex justify-content-between">
                    <h3 class="card-title">Sales</h3>
                    <a href="javascript:void(0);">View Report</a>
                </div>
            </div>
            <div class="card-body">
                <div class="d-flex">
                    <p class="d-flex flex-column">
                        <span id="chartAmount" class="text-bold text-lg"></span>
                        <span>Sales Over Time</span>
                    </p>
                    <p class="ml-auto d-flex flex-column text-right">
                        <span class="text-success">
                            <i class="fas fa-arrow-up"></i> 33.1%
                        </span>
                        <span class="text-muted">Since last month</span>
                    </p>
                </div>

                <div class="position-relative mb-4">
                    <div class="chartjs-size-monitor"><div class="chartjs-size-monitor-expand"><div class=""></div></div><div class="chartjs-size-monitor-shrink"><div class=""></div></div></div>
                    <canvas id="sales-chart" height="200" style="display: block; width: 487px; height: 200px;" width="487" class="chartjs-render-monitor"></canvas>
                </div>
                <div class="d-flex flex-row justify-content-end">
                    <span class="mr-2">
                        <i class="fas fa-square text-primary"></i> This year
                    </span>
                    <span>
                        <i class="fas fa-square text-gray"></i> Last year
                    </span>
                </div>
            </div>
        </div>

    </div>
</section>
<div id="piechart" style="width: 800px; height: 500px;"></div>
<button class="callChart" value="chart">chart</button>




@section scripts{


    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', { 'packages': ['bar'] });
        google.charts.setOnLoadCallback(LoadChart);

        function LoadChart() {
            //if (oTable) {
            //    $('#rdateSearch').clear().destroy();
            //    $('#todateSearch').clear().destroy();
            //    $('#daysSearch').clear().destroy();
            //}
            ajaxcall.post({
                url: AppConfig.ApiPath + "plot/GetChartSummary",
                "type": "POST",
                "processing": true,
                "serverSide": true,
                "datetype": "json",
                "data": {
                    rdate: $("#rdateSearch").val(),
                    todate: $("#todateSearch").val(),
                }
            }).then(function (res) {
                if (res) {

                    var dataArray = [['Year', 'Amount', 'Book']];
                    $.each(res, function (index, table) {

                        dataArray.push([res.Year, res.AmountReceived, res.Book]);
                    });
                    debugger
                    var data = google.visualization.arrayToDataTable(dataArray);

                    var options = {
                        chart: {
                            title: 'Company Performance',
                            subtitle: 'Sales, Expenses, and Profit: 2014-2017',
                        }
                    };

                    var chart = new google.charts.Bar(document.getElementById('piechart'));

                    chart.draw(data, google.charts.Bar.convertOptions(options));



                }
            }, err => {
                alertify.notify("Error while getting Dashboard summary date");
            });
        }
    </script>



    @*<script type="text/javascript">

        var oTable;
        $(function () {
            LoadTable();

        })

        $('#daysSearch').on('change', function (e) {


            var now = new Date();
            var day = ("0" + now.getDate()).slice(-2);
            var month = ("0" + (now.getMonth() + 1)).slice(-2);
            var today = now.getFullYear() + "-" + (month) + "-" + (day);
            debugger
            $('#todateSearch').val(today);


            var BeforeWeek = new Date(today);
            BeforeWeek = new Date(BeforeWeek.getFullYear(), now.getMonth(), now.getDate() - 6)
            var Weekday = ("0" + BeforeWeek.getDate()).slice(-2);
            var Weekmonth = ("0" + (BeforeWeek.getMonth() + 1)).slice(-2);
            var WeekDate = BeforeWeek.getFullYear() + "-" + (Weekmonth) + "-" + (Weekday);


            var BeforeMonthDate = new Date(today);
            BeforeMonthDate = new Date(BeforeMonthDate.setMonth(BeforeMonthDate.getMonth() - 1))
            var Monthday = ("0" + BeforeMonthDate.getDate()).slice(-2);
            var Monthmonth = ("0" + (BeforeMonthDate.getMonth() + 1)).slice(-2);
            var beforeMonth = BeforeMonthDate.getFullYear() + "-" + (Monthmonth) + "-" + (Monthday);



            var BeforeTwoMonth = new Date(today);
            BeforeTwoMonth = new Date(BeforeTwoMonth.setMonth(BeforeTwoMonth.getMonth() - 2))
            var TwoMonthDay = ("0" + BeforeTwoMonth.getDate()).slice(-2);
            var TwoMonthMonth = ("0" + (BeforeTwoMonth.getMonth() + 1)).slice(-2);
            var beforeTwo = BeforeTwoMonth.getFullYear() + "-" + (TwoMonthMonth) + "-" + (TwoMonthDay);

            var option = $(this).val();


            switch (option) {
                case '1Week':
                    $('#rdateSearch').val(WeekDate);
                    break;
                case '1Month':
                    $('#rdateSearch').val(beforeMonth);
                    break;
                case '2Month':
                    $('#rdateSearch').val(beforeTwo);
                    break;
                default:
                    $('#todateSearch').val("");
                    $('#rdateSearch').val("");
            }

            LoadTable()


        });

        function LoadTable() {
            if (oTable) {
                $('#rdateSearch').clear().destroy();
                $('#todateSearch').clear().destroy();
                $('#daysSearch').clear().destroy();
            }
            ajaxcall.post({
                url: AppConfig.ApiPath + "plot/GetdashboardSummary",
                "type": "POST",
                "processing": true,
                "serverSide": true,
                "datetype": "json",
                "data": {
                    rdate: $("#rdateSearch").val(),
                    todate: $("#todateSearch").val(),
                    rdays: $("#daysSearch").val(),
                }
            }).then(function (res) {
                if (res) {
                    $("#totalPaid").text(res.AmountReceived);
                    $("#Book").text(res.Book);
                    $("#Unbook").text(res.Unbook);
                    $("#Dastavej").text(res.Dastavej);
                    $("#Banakhat").text(res.Banakhat);
                    $("#chartAmount").text(res.AmountReceived);

                }
            }, err => {
                alertify.notify("Error while getting Dashboard summary date");
            });
        }



    </script>*@
}
