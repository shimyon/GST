@{
    Layout = "_Layout.cshtml";
}
<div class="container mt-3">
    <div class="row">
        <div class="col-md-6">
            <div class="form-group">
                <label>Site Name</label>
                <select class="form-control" id="SiteName" onchange="siteChange();">
                    <option value="0">Select</option>
                </select>
            </div>
        </div>
        <div class="col-md-6">
            <div class="form-group">
                <label>Shop/Office</label>
                <select class="form-control" id="PlotNo"></select>
            </div>
        </div>
    </div>


    <div class="" >
        <ul id="myTab" class="nav nav-tabs">
            <li class="active"><a class="nav-link" href="#Customer" data-toggle="tab" aria-selected="true">Customer</a></li>

            <li><a class="nav-link" href="#Payment" data-toggle="tab">Payment</a></li>
        </ul>
        <div id="Content" class="tab-content" style="height: 100%;">
            <div class="tab-pane fade in active" id="Customer">
                <table class="table table-hover dataTable no-footer">
                    <thead>
                        <tr>
                            <th style="max-width:100px;">&nbsp;</th>
                            <th>Name</th>
                            <th>Age</th>
                            <th>Mobile</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="max-width:80px;">
                                <button class="btnedit actionbtn btn  btn-sm" data-id="1"><i class="fa fa-edit"></i>Edit</button>
                                <button class="btnedit actionbtn btn  btn-sm" data-id="1"><i class="fa fa-trash"></i> Delete</button>
                            </td>
                            <td>Demo Customer</td>
                            <td>30</td>
                            <td>999999999</td>
                        </tr>
                    </tbody>
                </table>
                <div class="row">
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label>Name</label>
                            <input type="text" class="form-control" id="CustomerName">
                        </div>
                    </div>
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label for="inputAddress2">Age</label>
                            <input type="number" class="form-control" id="Age">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label>Adharcard</label>
                        <input type="text" class="form-control" id="AdharCard" maxlength="12">
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label>PAN Card</label>
                            <input type="text" class="form-control" id="PANCard">
                        </div>
                    </div>
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label for="inputAddress2">Address</label>
                            <input type="text" class="form-control" id="Address">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label>Mobile</label>
                        <input type="number" class="form-control" id="Mobile" maxlength="10">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" class="form-control" id="Email">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Sale Amount</label>
                            <input type="number" class="form-control" id="SaleAmount">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="form-group">
                            <label>Installments</label>
                            <input type="number" class="form-control" value="10" id="Installments">
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col col-md-1">
                        <button type="button" class="btn btn-primary" onclick="saveCustomerData();">Save</button>
                    </div>
                    <div class="col col-md-1">
                        <button type="button" class="btn btn-danger" onclick="goBack();">Cancel</button>
                    </div>
                    <div class="col col-md-2">
                        <button type="button" class="btn btn-primary" onclick="">Joint Holder</button>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="Payment">
                <div class="row">
                    <div class="col col-sm-6">
                        <h4>Sale Amount: 10,00,000</h4>
                    </div>
                    <div class="col col-sm-6 text-right text-danger">
                        <h4>Outstanding: 9,00,000</h4>
                    </div>
                </div>

                <table class="table table-hover dataTable no-footer">
                    <thead>
                        <tr>
                            <th style="max-width:100px;">&nbsp;</th>
                            <th>Date</th>
                            <th>Amount</th>
                            <th>Bank</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="max-width:80px;">
                                <button class="btnedit actionbtn btn  btn-sm" data-id="1"><i class="fa fa-edit"></i>Edit</button>
                                <button class="btnedit actionbtn btn  btn-sm" data-id="1"><i class="fa fa-trash"></i> Delete</button>
                            </td>
                            <td>27, Sep 2021</td>
                            <td>Rs. 1,00,000</td>
                            <td>BOB</td>
                        </tr>
                    </tbody>
                </table>
                <div class="row">
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label for="inputAddress2">Amount</label>
                            <input type="number" class="form-control" id="Ammount">
                        </div>
                    </div>
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label for="inputAddress2">Cheque No</label>
                            <input type="number" class="form-control" id="ChequeNo">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label>Bank</label>
                        <input type="text" class="form-control" id="Bank">
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" class="form-control" id="Date">
                        </div>
                    </div>
                    <div class="col-md-4 ">
                        <div class="form-group">
                            <label for="inputAddress2">SI No</label>
                            <input type="text" class="form-control" id="SINo">
                        </div>
                    </div>
                </div>


                <div class="row">
                    <div class="col col-md-1">
                        <button type="button" class="btn btn-primary" onclick="savePaymentData();">Save</button>
                    </div>
                    <div class="col col-md-1">
                        <button type="button" class="btn btn-danger" onclick="goBack();">Cancel</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>



@section scripts{
    <script type="text/javascript">
        var id = querySt("id");

        $(function () {
            $('a[href="#Customer"]').click();
            init();
        })

        async function init() {
           // await PlotIDDropDownAll();
            await SiteNameDropDownAll();
            if (id) {
                GetById();
            }
        }

        async function siteChange(){
            await PlotIDDropDownAll();
        }

        function PlotIDDropDownAll() {
            return new Promise((result, error) => {
                ajaxcall.get({
                    url: AppConfig.ApiPath + "Plot/PlotIDDropDownAll?Id=" + $("#SiteName").val() ,
                    data:{
                        Id:$("#SiteName").val()
                    }
                }).then((res) => {
                    if (res) {
                        $("#PlotNo").empty();
                        $("<option>").val("0").text("Select").appendTo("#PlotNo");
                        for (var i in res) {
                            $("<option>").val(res[i].value).text(res[i].label).appendTo("#PlotNo");
                        }
                    }
                    result();
                }, err => error(err));
            });
        }


        function SiteNameDropDownAll() {
            return new Promise((result, error) => {
                ajaxcall.get({
                    url: AppConfig.ApiPath + "Site/SiteNameDropDownAll"
                }).then((res) => {
                    if (res) {
                        for (var i in res) {
                            $("<option>").val(res[i].value).text(res[i].label).appendTo("#SiteName");
                            //document.getElementById("mySelect").disabled=false;
                            //$('#PlotNo').prop('disabled', false);
                        }
                    }
                    result();
                }, err => error(err));
            });
        }

        function GetById() {
            ajaxcall.post({
                url: AppConfig.ApiPath + "Customer/GetById",
                data: { "Id": id }
            }).then(function (res) {

                if (res) {
                    $("#CustomerName").val(res.CustomerName);
                    $("#Age").val(res.Age);
                    $("#AdharCard").val(res.AdharCard);
                    $("#PANCard").val(res.PANCard);
                    $("#Address").val(res.Address);
                    $("#Mobile").val(res.Mobile);
                    $("#Email").val(res.Email);
                }

            })
        }

        function saveCustomerData() {

            if (!$("#CustomerName").val()) {
                alert('Please enter Name');
                $("#CustomerName").focus()
                return false;
            }

            if (!$("#Age").val()) {
                alert('Please enter Age');
                $("#Age").focus()
                return false;
            }

            if (!$("#AdharCard").val()) {
                alert('Please enter AdharCard');
                $("#AdharCard").focus()
                return false;
            }

            if (!$("#PANCard").val()) {
                alert('Please enter PANCard');
                $("#PANCard").focus()
                return false;
            }

            if (!$("#Address").val()) {
                alert('Please enter Address');
                $("#Address").focus()
                return false;
            }

            if (!$("#Mobile").val()) {
                alert('Please enter Mobile');
                $("#Mobile").focus()
                return false;
            }

            if (!$("#Email").val()) {
                alert('Please enter Email');
                $("#Email").focus()
                return false;
            }

            ajaxcall.post({
                url: AppConfig.ApiPath + "Customer/AddData",
                data: {
                    Id: id,
                    CustomerName: $("#CustomerName").val(),
                    Age: $("#Age").val(),
                    AdharCard: $("#AdharCard").val(),
                    PANCard: $("#PANCard").val(),
                    Address: $("#Address").val(),
                    Mobile: $("#Mobile").val(),
                    Email: $("#Email").val()
                }
            }).then(res => {
                alert("Saved successfully");
                $('a[href="#Payment"]').click();
            }, err => {
                alert(err.responseJSON);
            })
        }


        function savePaymentData() {

            if (!$("#Ammount").val()) {
                alert('Please enter Ammount');
                $("#Ammount").focus()
                return false;
            }

            if (!$("#ChequeNo").val()) {
                alert('Please enter ChequeNo');
                $("#ChequeNo").focus()
                return false;
            }

            if (!$("#Bank").val()) {
                alert('Please enter Bank');
                $("#Bank").focus()
                return false;
            }

            if (!$("#Date").val()) {
                alert('Please enter Date');
                $("#Date").focus()
                return false;
            }

            if (!$("#SINo").val()) {
                alert('Please enter SI No');
                $("#SINo").focus()
                return false;
            }

            ajaxcall.post({
                url: AppConfig.ApiPath + "Payment/AddData",
                data: {
                    Id: id,
                    Ammount: $("#Ammount").val(),
                    ChequeNo: $("#ChequeNo").val(),
                    Bank: $("#Bank").val(),
                    Date: $("#Date").val(),
                    SINo: $("#SINo").val()
                }
            }).then(res => {
                alert("Saved successfully");
            }, err => {
                alert(err.responseJSON);
            })
        }

        function goBack() {
            window.history.back();
        }
    </script>
}